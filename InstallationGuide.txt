Quickstart — React (Vite) + Django REST (PowerShell-friendly)

This quick guide gets a teammate from a fresh clone to a running local dev environment (backend + frontend) on Windows PowerShell. It keeps commands copy-pasteable and focuses on the most common tasks.

Prerequisites
- Node.js (LTS), Python 3.11+ (3.12 recommended), Git.
- Optional: PostgreSQL for DB testing; the project defaults to SQLite for local dev.
Quickstart — React (Vite) + Django REST (PowerShell-friendly)

This short guide helps a teammate get the project running locally on Windows PowerShell. It focuses on the common, copy-pasteable steps for a developer machine.

Prerequisites
- Node.js (LTS), Python 3.11+ (3.12 recommended), Git
- Optional: PostgreSQL (the project defaults to SQLite for local dev)

1) Clone and open the repo

```powershell
git clone <repo-url>
cd SOEN-341-Events-Web-App
code .
```

2) Backend quickstart (Django)

Follow these steps from the repo root. If you prefer automation, the `scripts/start-backend.ps1` script runs the same steps.

- Create and activate a venv (one-time per machine):

```powershell
cd backend\collegeEventsWeb
# create venv if missing
python -m venv .venv
# activate for this session
.\.venv\Scripts\Activate.ps1
```

- Install dependencies:

```powershell
& '.\.venv\Scripts\python.exe' -m pip install --upgrade pip setuptools wheel
if (Test-Path requirements.txt) {
  & '.\.venv\Scripts\pip.exe' install -r requirements.txt
} else {
  & '.\.venv\Scripts\pip.exe' install django==5.2.7 djangorestframework django-cors-headers djangorestframework-simplejwt python-dotenv
}
```

- Apply migrations and create an admin (interactive):

```powershell
& '.\.venv\Scripts\python.exe' manage.py makemigrations
& '.\.venv\Scripts\python.exe' manage.py migrate --noinput
& '.\.venv\Scripts\python.exe' manage.py createsuperuser --email you@example.com
```

- Start the dev server:

```powershell
& '.\.venv\Scripts\python.exe' manage.py runserver 8000
```

If you encounter migration errors (for example: "no such column: \"start_at\"") it's often because your local SQLite file and the migration files have diverged. On a local dev machine one safe option is to remove the local SQLite DB and re-run migrations from scratch. WARNING: this deletes local data.

PowerShell one-liner (destructive; local dev only):

```powershell
Remove-Item backend\collegeEventsWeb\db.sqlite3 -Force -ErrorAction SilentlyContinue; Set-Location backend\collegeEventsWeb; & '.\.venv\Scripts\Activate.ps1'; & '.\.venv\Scripts\python.exe' manage.py migrate --noinput; & '.\.venv\Scripts\python.exe' manage.py createsuperuser
```

Or run the same steps separately for clarity:

```powershell
# delete local sqlite DB
Remove-Item backend\collegeEventsWeb\db.sqlite3 -Force

# go to project and activate venv
Set-Location backend\collegeEventsWeb
& '.\.venv\Scripts\Activate.ps1'

# recreate DB schema and optionally create a superuser
& '.\.venv\Scripts\python.exe' manage.py migrate --noinput
& '.\.venv\Scripts\python.exe' manage.py createsuperuser --email you@example.com
```

Quick notes
- Admin UI: http://127.0.0.1:8000/admin/
- API roots: /api/events/, /api/users/, /api/tickets/

3) Frontend quickstart (Vite + React)

Open a second terminal (repo root) and run:

```powershell
cd frontend
npm install   # first run only
npm run dev
```

Vite runs at http://localhost:5173 by default (may use 5174 if 5173 is busy). The frontend is configured to proxy `/api` → `http://localhost:8000`.

4) Helper scripts (recommended)

Use the provided helper scripts to simplify common developer tasks (they activate venvs, install missing deps, etc.):

```powershell
# from repo root
.\scripts\start-backend.ps1
.\scripts\start-frontend.ps1  # in a second terminal
```

5) Admin account patterns (safe)

Interactive (recommended):

```powershell
# run from backend\collegeEventsWeb with the venv activated
& '.\.venv\Scripts\python.exe' manage.py createsuperuser --email you@example.com
```

Non-interactive pattern (use env vars or a secret store; avoid hardcoding passwords):

```powershell
# set session vars (or read from secret manager)
$env:NEW_ADMIN_EMAIL='admin@example.com'
$env:NEW_ADMIN_NAME='Admin Name'
$env:NEW_ADMIN_PASSWORD='S3cureP@ssw0rd'  # prefer Read-Host or secret store

cd backend\collegeEventsWeb
.\.venv\Scripts\Activate.ps1
& '.\.venv\Scripts\python.exe' - <<'PY'
import os
os.environ.setdefault('DJANGO_SETTINGS_MODULE','collegeEventsWeb.settings')
import django; django.setup()
from user_accounts.models import User
email=os.environ.get('NEW_ADMIN_EMAIL')
name=os.environ.get('NEW_ADMIN_NAME')
password=os.environ.get('NEW_ADMIN_PASSWORD')
if not User.objects.filter(email=email).exists():
    User.objects.create_superuser(email=email, name=name, password=password)
    print('Superuser created:', email)
else:
    u = User.objects.get(email=email)
    u.set_password(password)
    u.role = User.Role.ADMIN
    u.status = User.Status.ACTIVE
    u.is_staff = True
    u.is_superuser = True
    u.save()
    print('User promoted to superuser (password updated):', email)
PY
```

There is also a `create_admin.py` template in the repo root — do not commit secrets into it. Prefer environment variables or a secret manager.

6) Discovering routes (list URL patterns)

Option A — install `django-extensions` (dev only):

```powershell
cd backend\collegeEventsWeb
.\.venv\Scripts\Activate.ps1
& '.\.venv\Scripts\pip.exe' install django-extensions
# add 'django_extensions' to INSTALLED_APPS in settings.py (dev only)
& '.\.venv\Scripts\python.exe' manage.py show_urls
```

Option B — inline (no extra deps):

```powershell
cd backend\collegeEventsWeb
.\.venv\Scripts\Activate.ps1
& '.\.venv\Scripts\python.exe' - <<'PY'
import os
os.environ.setdefault('DJANGO_SETTINGS_MODULE','collegeEventsWeb.settings')
import django; django.setup()
from django.urls import get_resolver
for p in get_resolver().url_patterns:
    print(p)
PY
```

7) How to call the API

Use the browser (DRF browsable API), curl, or PowerShell's `Invoke-RestMethod` for quick checks:

```powershell
Invoke-RestMethod -Uri http://127.0.0.1:8000/api/events/ -Method GET
```

Login via API (example): POST to `/api/users/login` with JSON `{"email":"...","password":"..."}` — the backend returns tokens and sets an HttpOnly cookie as configured.

8) Troubleshooting tips

- If venv activation is blocked, allow it for your session:

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process -Force
. .\.venv\Scripts\Activate.ps1
```

- To recreate a broken venv:

```powershell
Remove-Item -Recurse -Force .\.venv
python -m venv .venv
& '.\.venv\Scripts\python.exe' -m pip install --upgrade pip setuptools wheel
& '.\.venv\Scripts\pip.exe' install -r requirements.txt
```

- CSRF cookie issues (common when frontend calls backend directly):
  - Prefer using Vite's proxy (default) so the browser treats API requests as same-origin.
  - If you call the backend directly on `http://localhost:8000`, ensure `CORS_ALLOW_CREDENTIALS = True` and set cookie SameSite/secure flags correctly in `settings.py` (dev-only changes may be needed).

- If migrations fail because migrations and DB are out of sync, follow the "delete DB and recreate" steps above (dev-only, destructive) or fake-apply migrations if you need to preserve data.

9) Improvements I can add (pick one)

- Convert `create_admin.py` into a management command: `manage.py create_admin --email ...` (recommended)
- Add DRF OpenAPI + docs endpoints (`/openapi/`, `/docs/`)
- Add a management command to print friendly routes

If you'd like, tell me which improvement to implement and I will make the change and verify it locally.

--

Quicker commands reference (copy-paste)

```powershell
# activate backend venv
Set-Location backend\collegeEventsWeb
& '.\.venv\Scripts\Activate.ps1'

# run migrations
& '.\.venv\Scripts\python.exe' manage.py migrate --noinput

# create admin (interactive)
& '.\.venv\Scripts\python.exe' manage.py createsuperuser --email you@example.com

# start frontend (in a separate terminal)
Set-Location frontend
npm install
npm run dev
```

# Omit --password to be prompted securely.
```

2) Wrapper (prompts securely)
```powershell
# from repo root
.\scripts\create-admin.ps1
```

Note: this repository contains multiple Django project folders in history. The canonical dev project is
`backend/collegeEventsWeb` — all `manage.py` commands shown in this guide assume you are in that directory
or explicitly call that `manage.py`. If you see an older `manage.py` under `backend/`, it is legacy and may be
archived or removed to avoid confusion.


